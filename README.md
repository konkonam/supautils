Utilities to generate Zod schemas from Supabase/Postgres

## Installation

```bash
npm i supautils -D
```

## Usage

Currently the package only offers codegen functionality.

### via CLI

You can generate the schemas using the CLI:

> Note: The CLI will try to automatically detect the database connection string

```bash
npx supautils gen:schemas
```

| Option | Description | Default |
| --- | --- | --- |
| `--out` or `--output` | Output file path | `./generated/cli` |
| `--url` | Database connection string | `DATABASE_URL` env variable |
| `--schemas` | Schemas to generate | `public` |

### via Code

You can also generate the schemas using code:

```ts
import { generateOutputs, writeOutputs } from 'supautils/codegen'

const outs = await generateOutputs({
    url: 'postgresql://postgres:postgres@localhost:54322/postgres',
    tables: [
        'public.*',
        'auth.users',
    ],
    outputDir: './generated/lib',
    hooks: {
        'map:before': async (context) => {},
        'map:after': async (context) => {},
        'write:before': async (output) => {},
        'write:after': async (output) => {},
    },
    outputs: [ zod, types ],
}).catch(() => [])

await writeOutputs(outs)
```

and running it will generate something like this:

#### `generated/cli/zod.ts`

```ts
// This file is generated by supautils

import { z } from 'zod'

export const users = z.object({
    id: z.string(),
    // ...
})

export const addresses = z.object({
    id: z.string(),
    // ...
})

export const comments = z.object({
    id: z.string(),
    // ...
})

export const companies = z.object({
    id: z.string(),
    // ...
})
```

#### `generated/cli/types.ts`

```ts
// This file is generated by supautils

import type * as schemas from './schemas'
import type { z } from 'zod'

export type Users = z.infer<typeof schemas.users>

export type Addresses = z.infer<typeof schemas.addresses>

export type Comments = z.infer<typeof schemas.comments>

export type Companies = z.infer<typeof schemas.companies>

```